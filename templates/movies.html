{% extends "base.html" %}
{% block title %}Movies of {{ user.name }} | Movi-Web{% endblock %}

{% block content %}
<a href="{{ url_for('index') }}" class="muted">&larr; Back</a>

<h2>Favorites of {{ user.name }}</h2>

{% if movies %}
  <ul class="list">
    {% for m in movies %}
     <li class="movie-row" style="margin-bottom: 1em; display: flex; gap: 1em;">
  {% if m.poster_url %}
    <img src="{{ m.poster_url }}" alt="{{ m.title }}" width="100">
  {% endif %}

  <div>
    <strong>{{ m.title }}</strong>
    {% if m.year %} ({{ m.year }}){% endif %}
    {% if m.imdb_id %}<br><small class="muted">IMDb: {{ m.imdb_id }}</small>{% endif %}

    <div style="margin-top: 0.5em;">
      <form method="post" action="{{ url_for('update_movie', user_id=user.id, movie_id=m.id) }}" class="inline">
        <input name="new_title" placeholder="New title" required>
        <button type="submit">Update</button>
      </form>

      <form method="post" action="{{ url_for('delete_movie', user_id=user.id, movie_id=m.id) }}" class="inline" style="display:inline;">
        <button type="submit">Delete</button>
      </form>
    </div>
  </div>
</li>
    {% endfor %}
  </ul>
{% else %}
  <p>No movies saved yet.</p>
{% endif %}

<section class="card" style="margin-top: 2em;">
  <h3>Add movie</h3>
  <form method="post" action="{{ url_for('add_movie', user_id=user.id) }}">
    <div class="row">
      <label for="title">Title</label>
      <input id="title" name="title" required>
    </div>
    <div class="row">
      <label for="year">Year (optional)</label>
      <input id="year" name="year" placeholder="1999">
    </div>
    <button type="submit">Add</button>
  </form>
</section>
{% endblock %}
